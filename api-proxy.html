<!DOCTYPE html>
<html>
<head>
    <title>API Proxy</title>
    <script>
        // Handle API calls via this page to bypass CORS
        async function handleAPICall() {
            const urlParams = new URLSearchParams(window.location.search);
            const endpoint = urlParams.get('endpoint');
            const method = urlParams.get('method') || 'POST';
            const data = urlParams.get('data');
            
            if (!endpoint) {
                window.parent.postMessage({ error: 'No endpoint specified' }, '*');
                return;
            }
            
            try {
                const response = await fetch(`https://vanguardescrow-api-4.onrender.com/${endpoint}`, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: data || '{}'
                });
                
                const result = await response.json();
                window.parent.postMessage({ 
                    success: true, 
                    data: result,
                    status: response.status 
                }, '*');
                
            } catch (error) {
                window.parent.postMessage({ 
                    success: false, 
                    error: error.message 
                }, '*');
            }
        }
        
        // Run when page loads
        window.addEventListener('load', handleAPICall);
    </script>
</head>
<body>
    <!-- This page acts as a CORS bypass proxy -->
    Processing API request...
</body>
</html>
