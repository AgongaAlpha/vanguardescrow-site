<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title data-i18n="title">
   Seller Dashboard ‚Äî VanGuard Escrow
  </title>

<script src="https://cdn.jsdelivr.net/npm/i18next@23.7.6/i18next.min.js"></script>
<style>
   body{font-family:"Segoe UI",sans-serif;background:#f8fafc;margin:0;color:#0f172a;}
    header{background:linear-gradient(90deg,#1e40af,#3b82f6);color:white;padding:12px 16px;font-weight:700;display:flex;justify-content:space-between;align-items:center;}
    .header-left{display:flex;align-items:center;gap:12px}
    header button{background:white;color:#0f172a;border:none;border-radius:6px;padding:6px 12px;font-weight:600;cursor:pointer;}
    header select{padding:6px;border-radius:6px;border:none;font-weight:700}
    .container{max-width:1000px;margin:20px auto;padding:20px;}
    nav{display:flex;gap:12px;margin-bottom:20px;}
    nav button{flex:1;padding:12px;border:none;border-radius:8px;background:#e2e8f0;cursor:pointer;font-weight:600;}
    nav button.active{background:linear-gradient(90deg,#1e40af,#3b82f6);color:white;}
    .card{background:white;border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 2px 8px rgba(0,0,0,0.06);}
    h2{margin-top:0;}
    textarea,input{width:100%;padding:10px;margin-top:8px;border:1px solid #cbd5e1;border-radius:8px;font-size:14px;}
    button.action{margin-top:12px;padding:10px 16px;border:none;border-radius:8px;background:linear-gradient(90deg,#1e40af,#3b82f6);color:white;font-weight:600;cursor:pointer;}
    .wallet-box{font-family:monospace;padding:10px;background:#f1f5f9;border-radius:8px;margin-top:8px;display:flex;justify-content:space-between;align-items:center;}
    .msg{margin-top:10px;padding:8px 10px;border-radius:8px;font-size:13px;}
    .msg.success{background:rgba(16,185,129,0.08);color:#059669;}
    .msg.error{background:rgba(239,68,68,0.08);color:#dc2626;}
    table{width:100%;border-collapse:collapse;margin-top:10px;}
    th,td{padding:10px;border-bottom:1px solid #e2e8f0;text-align:left;vertical-align:middle;}
    .payment-list{display:flex;flex-direction:column;gap:10px;margin-top:8px}
    .payment-item{display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;background:#fbfdff;border:1px solid rgba(2,6,23,0.03)}
    .method-label{font-weight:700}
    .method-note{font-size:13px;color:#6b7280}
    .small-note{font-size:13px;color:#6b7280;margin-top:8px}
    .copy-btn{padding:6px 10px;border-radius:8px;border:none;background:linear-gradient(90deg,#1e40af,#3b82f6);color:#fff;cursor:pointer;font-weight:600}
    .use-btn{padding:6px 10px;border-radius:8px;border:1px solid #cbd5e1;background:white;color:#0f172a;cursor:pointer}
    .selected-display{margin-top:8px;padding:8px;border-radius:8px;background:#f1f5f9;display:flex;justify-content:space-between;align-items:center;font-family:monospace}
    .file-list{margin-top:10px;padding:10px;background:#f8fafc;border-radius:8px;font-size:13px;}
    .file-item{padding:6px;background:white;border-radius:4px;margin-top:4px;display:flex;justify-content:space-between;align-items:center;}
  </style>
</head>
<body>
<header>
<div class="header-left">
<span data-i18n="header.title" id="headerTitle">
     Seller Dashboard
    </span>
<a href="/index.html" style="margin-left:20px;color:white;text-decoration:none;font-weight:500;font-size:14px;padding:6px 12px;border:1px solid rgba(255,255,255,0.3);border-radius:6px;transition:all 0.2s" onmouseover="this.style.background='rgba(255,255,255,0.2)'" onmouseout="this.style.background='transparent'">üè† Home</a>
</div>
<div style="display:flex;align-items:center;gap:10px">
<select aria-label="Language selector" id="langSwitcher">
<option value="en">
      English
     </option>
<option value="de">
      Deutsch
     </option>
<option value="fr">
      Fran√ßais
     </option>
<option value="it">
      Italiano
     </option>
<option value="es">
      Espa√±ol
     </option>
</select>
<button data-i18n="btn.logout" id="logoutBtn">
     Logout
    </button>
</div>
</header>
<div class="container">
<nav aria-label="main-nav">
<button class="active" data-i18n="nav.escrow" id="tabEscrow">
     Escrow Setup
    </button>
<button data-i18n="nav.my_escrows" id="tabMyEscrows">
     My Escrows
    </button>
<button data-i18n="nav.transactions" id="tabTransactions">
     Transactions
    </button>
<button data-i18n="nav.kyc" id="tabKYC">
     KYC
    </button>
</nav>
<div id="escrowSection">
<div class="card">
<h2 data-i18n="pending.h2">Pending Escrows</h2>
<p data-i18n="pending.desc">Review buyer-initiated escrow requests awaiting your confirmation.</p>
<table>
<thead>
<tr>
<th data-i18n="tbl.id">ID</th>
<th data-i18n="tbl.buyer">Buyer</th>
<th data-i18n="tbl.amount">Amount</th>
<th data-i18n="tbl.actions">Actions</th>
</tr>
</thead>
<tbody id="pendingEscrowTable">
<tr>
<td colspan="4" style="text-align:center;color:#6b7280;">Loading pending escrows...</td>
</tr>
</tbody>
</table>
</div>

<div class="card">
<h2 data-i18n="delivery.h2">Submit Delivery & Terms</h2>
<form id="deliveryForm">
<input id="escrowIdDelivery" name="escrowId" placeholder="Escrow ID" type="text" data-i18n-placeholder="ph.escrow_id"/>
<label for="deliveryTerms" style="display:block;margin-top:12px;font-weight:600;" data-i18n="label.delivery_terms">Delivery Terms:</label>
<textarea id="deliveryTerms" name="deliveryTerms" placeholder="Describe your deliverables or terms..." data-i18n-placeholder="ph.delivery_terms"></textarea>
<label for="deliverableContent" style="display:block;margin-top:12px;font-weight:600;" data-i18n="label.deliverable_content">Deliverable Content:</label>
<textarea id="deliverableContent" name="deliverableContent" placeholder="Paste deliverable text, download links, or instructions..." data-i18n-placeholder="ph.deliverable_content"></textarea>
<label for="attachFiles" style="display:block;margin-top:12px;font-weight:600;" data-i18n="label.attach_files">Attach Files:</label>
<input id="attachFiles" name="files" type="file" multiple style="margin-top:8px;"/>
<div class="file-list" id="filePreview" style="display:none;">
<strong data-i18n="label.selected_files">Selected Files:</strong>
<div id="fileListContent"></div>
</div>
<button class="action" id="submitDeliveryBtn" type="submit" data-i18n="btn.submit_delivery">Submit Delivery</button>
<div class="msg" id="deliveryMsg"></div>
</form>
</div>

<div class="card">
<h2 data-i18n="release.h2">Request Payment Release</h2>
<p data-i18n="release.desc">Request the buyer to release payment after completing the delivery.</p>
<form id="releaseRequestForm">
<input id="escrowIdRelease" name="escrowId" placeholder="Escrow ID" type="text" data-i18n-placeholder="ph.escrow_id"/>
<button class="action" id="requestReleaseBtn" type="submit" data-i18n="btn.request_release">Request Release</button>
<div class="msg" id="releaseRequestMsg"></div>
</form>
</div>

<div class="card" id="withdrawalMethodsCard">
<h2 data-i18n="withdrawal.h2">
      Choose Withdrawal Method
     </h2>
<p data-i18n="withdrawal.desc">Select how you would like to receive your payout once the escrow is completed.</p>
<div class="payment-list" id="paymentList">
<div class="payment-item">
<input id="pm_trc" name="withdrawalMethod" type="radio" value="TKTVFbMAyEh6p9kydRNfavxy6hEvyfsTBR"/>
<div style="flex:1">
<div class="method-label" data-i18n="method.trc">
         USDT TRC20
        </div>
<div class="method-note" data-val="TKTVFbMAyEh6p9kydRNfavxy6hEvyfsTBR">
         TKTVFbMAyEh6p9kydRNfavxy6hEvyfsTBR
        </div>
</div>
<button class="copy-btn" data-i18n="btn.copy" data-val="TKTVFbMAyEh6p9kydRNfavxy6hEvyfsTBR">
        Copy
       </button>
<button class="use-btn" data-i18n="btn.select_withdrawal" data-val="TKTVFbMAyEh6p9kydRNfavxy6hEvyfsTBR">
        Select Withdrawal Method
       </button>
</div>
<div class="payment-item">
<input id="pm_erc" name="withdrawalMethod" type="radio" value="0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02"/>
<div style="flex:1">
<div class="method-label" data-i18n="method.erc">
         USDT ERC20
        </div>
<div class="method-note" data-val="0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02">
         0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02
        </div>
</div>
<button class="copy-btn" data-i18n="btn.copy" data-val="0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02">
        Copy
       </button>
<button class="use-btn" data-i18n="btn.select_withdrawal" data-val="0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02">
        Select Withdrawal Method
       </button>
</div>
<div class="payment-item">
<input id="pm_bep20" name="withdrawalMethod" type="radio" value="0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02"/>
<div style="flex:1">
<div class="method-label" data-i18n="method.bep">
         BTC (BEP20)
        </div>
<div class="method-note" data-val="0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02">
         0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02
        </div>
</div>
<button class="copy-btn" data-i18n="btn.copy" data-val="0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02">
        Copy
       </button>
<button class="use-btn" data-i18n="btn.select_withdrawal" data-val="0x2bc86574cd42770bdb208f37b7d1d94e5f6d4f02">
        Select Withdrawal Method
       </button>
</div>
<div class="payment-item">
<input id="pm_cashapp" name="withdrawalMethod" type="radio" value="$VanguardAdams"/>
<div style="flex:1">
<div class="method-label" data-i18n="method.cashapp">
         Cash App (US only)
        </div>
<div class="method-note" data-val="$VanguardAdams">
         $VanguardAdams
        </div>
</div>
<button class="copy-btn" data-i18n="btn.copy" data-val="$VanguardAdams">
        Copy
       </button>
<button class="use-btn" data-i18n="btn.select_withdrawal" data-val="$VanguardAdams">
        Select Withdrawal Method
       </button>
</div>
<div class="payment-item">
<div style="flex:1">
<div class="method-label" data-i18n="method.bank">
         Bank Transfer (Revolut Instant)
        </div>
<div class="method-note" data-i18n="method.bank_note">
         Chat Live Admin on our Google Meet link or email support@vanguardescrow.online
        </div>
</div>
<button class="copy-btn" data-i18n="btn.info" data-val="BankTransferInfo">
        Info
       </button>
<button class="use-btn" data-i18n="btn.select_withdrawal" data-val="BANK_TRANSFER">
        Select Withdrawal Method
       </button>
</div>
</div>
<div style="margin-top:12px">
<input data-i18n-placeholder="ph.custom" id="customPayment" placeholder=""/>
<button class="use-btn" data-i18n="btn.use_custom" id="useCustomBtn">
       Use Custom
      </button>
</div>
<div class="selected-display" id="selectedPaymentDisplay" style="display:none">
<span id="selectedPaymentText">
       --
      </span>
<button class="use-btn" data-i18n="btn.clear" id="clearSelected">
       Clear
      </button>
</div>
<div class="small-note" data-i18n="note.bank_limit">
      NB: Bank transfers aren't supported for transfers above $5000. For bank transfer assistance use Google Meet or support@vanguardescrow.online.
     </div>
</div>
</div>
<div id="myEscrowsSection" style="display:none;">
<div class="card">
<h2 data-i18n="my.h2">
      My Escrows
     </h2>
<table>
<thead>
<tr>
<th data-i18n="tbl.id">
         ID
        </th>
<th data-i18n="tbl.status">
         Status
        </th>
<th data-i18n="tbl.amount">
         Amount
        </th>
<th data-i18n="tbl.wallet">
         Wallet
        </th>
</tr>
</thead>
<tbody id="escrowTable">
</tbody>
</table>
</div>
</div>
<div id="transactionsSection" style="display:none;">
<div class="card">
<h2 data-i18n="transactions.h2">
      Transactions
     </h2>
<ul id="transactionsList">
</ul>
</div>
</div>
<div id="kycSection" style="display:none;">
<div class="card">
<h2 data-i18n="kyc.h2">
      KYC
     </h2>
<p data-i18n="kyc.note">
      KYC verification will be demanded for sellers who choose to receive payment via Bank Transfer.
     </p>
</div>
</div>
</div>

<script>
let currentUser = null;

async function checkSession() {
  try {
    const res = await fetch('https://vanguardescrow.online/.netlify/functions/me', {
      method: 'GET',
      credentials: 'include'
    });
    
    if (!res.ok) {
      console.warn('No valid session found.');
      return false;
    }
    
    const data = await res.json();
    currentUser = data;
    
    if (currentUser.role !== 'seller') {
      console.warn('Access denied. Wrong dashboard for your role.');
      return false;
    }
    
    console.log('Session valid for seller:', currentUser.email);
    return true;
  } catch (error) {
    console.error('Session check failed:', error);
    return false;
  }
}

window.addEventListener("DOMContentLoaded", async () => {
  console.log('Seller Dashboard initializing...');
  
  await checkSession();

  async function handleEscrowAction(escrowId, endpoint, msgId, actionName) {
    const msg = document.getElementById(msgId);
    if (msg) {
      msg.innerHTML = "Processing...";
      msg.className = "msg";
    }

    try {
      const res = await fetch(endpoint, { 
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        credentials: 'include',
        body: JSON.stringify({ escrowId })
      });

      if (res.status === 401) {
        console.error('401 Unauthorized - session invalid');
        if (msg) {
          msg.innerHTML = `Session expired. Please log in again.`;
          msg.className = "msg error";
        }
        return; 
      }
      
      let text = await res.text();
      let json;
      try { json = JSON.parse(text); } catch { json = null; }

      if (!res.ok) throw new Error(json?.error || ("HTTP " + res.status));

      if (msg) {
        msg.innerHTML = "‚úÖ " + actionName + " successful!";
        msg.className = "msg success";
      }
      console.log(actionName + " success:", json);
      
    } catch (err) {
      if (msg) {
        msg.innerHTML = "‚ùå " + (err.message || "Network/System Error");
        msg.className = "msg error";
      }
      console.error(actionName + " error:", err);
    }
  }

  async function handleDeliverySubmit(e) {
    e.preventDefault();
    const form = e.target;
    const msg = document.getElementById('deliveryMsg');
    msg.innerHTML = "Processing...";
    msg.className = "msg";

    try {
      const formData = new FormData(form);
      
      const res = await fetch("https://vanguardescrow.online/.netlify/functions/sellerSubmitDelivery", { 
        method: "POST",
        credentials: 'include',
        body: formData
      });

      if (res.status === 401) {
        console.error('401 Unauthorized - session invalid');
        msg.innerHTML = `Session expired. Please log in again.`;
        msg.className = "msg error";
        return; 
      }
      
      let text = await res.text();
      let json;
      try { json = JSON.parse(text); } catch { json = null; }

      if (!res.ok) throw new Error(json?.error || ("HTTP " + res.status));

      msg.innerHTML = "‚úÖ Delivery submitted successfully!";
      msg.className = "msg success";
      console.log("Delivery submit success:", json);
      form.reset();
      document.getElementById('filePreview').style.display = 'none';
      
    } catch (err) {
      msg.innerHTML = "‚ùå " + (err.message || "Network/System Error");
      msg.className = "msg error";
      console.error("Delivery submit error:", err);
    }
  }

  async function handleReleaseRequest(e) {
    e.preventDefault();
    const form = e.target;
    const msg = document.getElementById('releaseRequestMsg');
    msg.innerHTML = "Processing...";
    msg.className = "msg";
    const data = Object.fromEntries(new FormData(form).entries());

    try {
      const res = await fetch("https://vanguardescrow.online/.netlify/functions/sellerRequestRelease", { 
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        credentials: 'include',
        body: JSON.stringify(data)
      });

      if (res.status === 401) {
        console.error('401 Unauthorized - session invalid');
        msg.innerHTML = `Session expired. Please log in again.`;
        msg.className = "msg error";
        return; 
      }
      
      let text = await res.text();
      let json;
      try { json = JSON.parse(text); } catch { json = null; }

      if (!res.ok) throw new Error(json?.error || ("HTTP " + res.status));

      msg.innerHTML = "‚úÖ Release request sent successfully!";
      msg.className = "msg success";
      console.log("Release request success:", json);
      
    } catch (err) {
      msg.innerHTML = "‚ùå " + (err.message || "Network/System Error");
      msg.className = "msg error";
      console.error("Release request error:", err);
    }
  }

  const base = "https://vanguardescrow.online/.netlify/functions";
  
  document.getElementById("deliveryForm")?.addEventListener("submit", handleDeliverySubmit);
  document.getElementById("releaseRequestForm")?.addEventListener("submit", handleReleaseRequest);

  document.getElementById("attachFiles")?.addEventListener("change", function(e) {
    const files = e.target.files;
    const preview = document.getElementById('filePreview');
    const listContent = document.getElementById('fileListContent');
    
    if (files.length > 0) {
      preview.style.display = 'block';
      listContent.innerHTML = '';
      for (let i = 0; i < files.length; i++) {
        const fileItem = document.createElement('div');
        fileItem.className = 'file-item';
        fileItem.innerHTML = `<span>${files[i].name}</span><span style="color:#6b7280;">${(files[i].size / 1024).toFixed(1)} KB</span>`;
        listContent.appendChild(fileItem);
      }
    } else {
      preview.style.display = 'none';
    }
  });

  window.confirmEscrow = function(escrowId) {
    handleEscrowAction(escrowId, base + "/sellerConfirm", "pendingMsg_" + escrowId, "Confirm Escrow");
  };

  window.rejectEscrow = function(escrowId) {
    handleEscrowAction(escrowId, base + "/sellerReject", "pendingMsg_" + escrowId, "Reject Escrow");
  };

  document.getElementById("logoutBtn")?.addEventListener("click", async () => {
    try {
      await fetch('https://vanguardescrow.online/.netlify/functions/logout', {
        method: 'POST',
        credentials: 'include'
      });
      console.log('Logged out successfully');
    } catch (error) {
      console.error('Logout error:', error);
    }
  });
});
</script>
<script id="tabControl">
document.addEventListener("DOMContentLoaded", () => {
  console.log("Tab system initialized");

  const tabs = {
    tabEscrow: "escrowSection",
    tabMyEscrows: "myEscrowsSection",
    tabTransactions: "transactionsSection",
    tabKYC: "kycSection"
  };

  const buttons = Object.keys(tabs).map(id => document.getElementById(id)).filter(btn => btn);
  const sections = Object.values(tabs).map(id => document.getElementById(id)).filter(sec => sec);

  function showSection(showId) {
    sections.forEach(sec => {
      sec.style.display = (sec.id === showId) ? "block" : "none";
    });

    buttons.forEach(btn => {
      const target = tabs[btn.id];
      if (target === showId) {
        btn.classList.add("active");
      } else {
        btn.classList.remove("active");
      }
    });
  }

  buttons.forEach(btn => {
    btn.addEventListener("click", () => {
      const targetId = tabs[btn.id];
      if (targetId) {
        showSection(targetId);
      }
    });
  });

  showSection("escrowSection");
});
</script>
<script id="i18nAndWalletFeatures">
const translations = {
  en: {
    translation: {
      "title": "Seller Dashboard ‚Äî VanGuard Escrow",
      "header.title": "Seller Dashboard",
      "btn.logout": "Logout",
      "nav.escrow": "Escrow Setup",
      "nav.my_escrows": "My Escrows",
      "nav.transactions": "Transactions",
      "nav.kyc": "KYC",
      "pending.h2": "Pending Escrows",
      "pending.desc": "Review buyer-initiated escrow requests awaiting your confirmation.",
      "delivery.h2": "Submit Delivery & Terms",
      "release.h2": "Request Payment Release",
      "release.desc": "Request the buyer to release payment after completing the delivery.",
      "withdrawal.h2": "Choose Withdrawal Method",
      "withdrawal.desc": "Select how you would like to receive your payout once the escrow is completed.",
      "method.trc": "USDT TRC20",
      "method.erc": "USDT ERC20",
      "method.bep": "BTC (BEP20)",
      "method.cashapp": "Cash App (US only)",
      "method.bank": "Bank Transfer (Revolut Instant)",
      "method.bank_note": "Chat Live Admin on our Google Meet link or email support@vanguardescrow.online",
      "btn.copy": "Copy",
      "btn.select_withdrawal": "Select Withdrawal Method",
      "btn.info": "Info",
      "btn.use_custom": "Use Custom",
      "btn.clear": "Clear",
      "btn.submit_delivery": "Submit Delivery",
      "btn.request_release": "Request Release",
      "btn.confirm_escrow": "Confirm Escrow",
      "btn.reject_escrow": "Reject Escrow",
      "ph.custom": "Enter custom withdrawal method",
      "ph.escrow_id": "Escrow ID",
      "ph.delivery_terms": "Describe your deliverables or terms...",
      "ph.deliverable_content": "Paste deliverable text, download links, or instructions...",
      "label.delivery_terms": "Delivery Terms:",
      "label.deliverable_content": "Deliverable Content:",
      "label.attach_files": "Attach Files:",
      "label.selected_files": "Selected Files:",
      "note.bank_limit": "NB: Bank transfers aren't supported for transfers above $5000. For bank transfer assistance use Google Meet or support@vanguardescrow.online.",
      "my.h2": "My Escrows",
      "tbl.id": "ID",
      "tbl.buyer": "Buyer",
      "tbl.status": "Status",
      "tbl.amount": "Amount",
      "tbl.wallet": "Wallet",
      "tbl.actions": "Actions",
      "transactions.h2": "Transactions",
      "kyc.h2": "KYC",
      "kyc.note": "KYC verification will be demanded for sellers who choose to receive payment via Bank Transfer."
    }
  },
  de: {
    translation: {
      "title": "Verk√§ufer-Dashboard ‚Äî VanGuard Escrow",
      "header.title": "Verk√§ufer-Dashboard",
      "btn.logout": "Abmelden",
      "nav.escrow": "Escrow-Einrichtung",
      "nav.my_escrows": "Meine Escrows",
      "nav.transactions": "Transaktionen",
      "nav.kyc": "KYC",
      "pending.h2": "Ausstehende Escrows",
      "pending.desc": "√úberpr√ºfen Sie vom K√§ufer initiierte Escrow-Anfragen, die auf Ihre Best√§tigung warten.",
      "delivery.h2": "Lieferung & Bedingungen einreichen",
      "release.h2": "Zahlungsfreigabe anfordern",
      "release.desc": "Fordern Sie den K√§ufer auf, die Zahlung nach Abschluss der Lieferung freizugeben.",
      "withdrawal.h2": "Auszahlungsmethode w√§hlen",
      "withdrawal.desc": "W√§hlen Sie aus, wie Sie Ihre Auszahlung nach Abschluss des Escrow erhalten m√∂chten.",
      "method.trc": "USDT TRC20",
      "method.erc": "USDT ERC20",
      "method.bep": "BTC (BEP20)",
      "method.cashapp": "Cash App (nur USA)",
      "method.bank": "Bank√ºberweisung (Revolut Instant)",
      "method.bank_note": "Live-Admin √ºber Google Meet kontaktieren oder E-Mail an support@vanguardescrow.online",
      "btn.copy": "Kopieren",
      "btn.select_withdrawal": "Auszahlungsmethode ausw√§hlen",
      "btn.info": "Info",
      "btn.use_custom": "Benutzerdefiniert verwenden",
      "btn.clear": "L√∂schen",
      "btn.submit_delivery": "Lieferung einreichen",
      "btn.request_release": "Freigabe anfordern",
      "btn.confirm_escrow": "Escrow best√§tigen",
      "btn.reject_escrow": "Escrow ablehnen",
      "ph.custom": "Benutzerdefinierte Auszahlungsmethode eingeben",
      "ph.escrow_id": "Escrow-ID",
      "ph.delivery_terms": "Beschreiben Sie Ihre Liefergegenst√§nde oder Bedingungen...",
      "ph.deliverable_content": "F√ºgen Sie Liefertext, Download-Links oder Anweisungen ein...",
      "label.delivery_terms": "Lieferbedingungen:",
      "label.deliverable_content": "Lieferinhalt:",
      "label.attach_files": "Dateien anh√§ngen:",
      "label.selected_files": "Ausgew√§hlte Dateien:",
      "note.bank_limit": "Hinweis: Bank√ºberweisungen werden nicht f√ºr Betr√§ge √ºber 5000 $ unterst√ºtzt.",
      "my.h2": "Meine Escrows",
      "tbl.id": "ID",
      "tbl.buyer": "K√§ufer",
      "tbl.status": "Status",
      "tbl.amount": "Betrag",
      "tbl.wallet": "Wallet",
      "tbl.actions": "Aktionen",
      "transactions.h2": "Transaktionen",
      "kyc.h2": "KYC",
      "kyc.note": "KYC-Verifizierung wird f√ºr Verk√§ufer verlangt, die per Bank√ºberweisung bezahlt werden m√∂chten."
    }
  },
  fr: {
    translation: {
      "title": "Tableau de bord vendeur ‚Äî VanGuard Escrow",
      "header.title": "Tableau de bord vendeur",
      "btn.logout": "D√©connexion",
      "nav.escrow": "Configuration Escrow",
      "nav.my_escrows": "Mes Escrows",
      "nav.transactions": "Transactions",
      "nav.kyc": "KYC",
      "pending.h2": "Escrows en attente",
      "pending.desc": "Examinez les demandes d'escrow initi√©es par l'acheteur en attente de votre confirmation.",
      "delivery.h2": "Soumettre la livraison et les conditions",
      "release.h2": "Demander la lib√©ration du paiement",
      "release.desc": "Demandez √† l'acheteur de lib√©rer le paiement apr√®s avoir termin√© la livraison.",
      "withdrawal.h2": "Choisir la m√©thode de retrait",
      "withdrawal.desc": "S√©lectionnez comment vous souhaitez recevoir votre paiement une fois l'escrow termin√©.",
      "method.trc": "USDT TRC20",
      "method.erc": "USDT ERC20",
      "method.bep": "BTC (BEP20)",
      "method.cashapp": "Cash App (USA uniquement)",
      "method.bank": "Virement bancaire (Revolut Instant)",
      "method.bank_note": "Contactez l'administrateur en direct via Google Meet ou par e-mail support@vanguardescrow.online",
      "btn.copy": "Copier",
      "btn.select_withdrawal": "S√©lectionner la m√©thode de retrait",
      "btn.info": "Info",
      "btn.use_custom": "Utiliser personnalis√©",
      "btn.clear": "Effacer",
      "btn.submit_delivery": "Soumettre la livraison",
      "btn.request_release": "Demander la lib√©ration",
      "btn.confirm_escrow": "Confirmer l'escrow",
      "btn.reject_escrow": "Rejeter l'escrow",
      "ph.custom": "Entrez une m√©thode de retrait personnalis√©e",
      "ph.escrow_id": "ID Escrow",
      "ph.delivery_terms": "D√©crivez vos livrables ou conditions...",
      "ph.deliverable_content": "Collez le texte livrable, les liens de t√©l√©chargement ou les instructions...",
      "label.delivery_terms": "Conditions de livraison:",
      "label.deliverable_content": "Contenu livrable:",
      "label.attach_files": "Joindre des fichiers:",
      "label.selected_files": "Fichiers s√©lectionn√©s:",
      "note.bank_limit": "NB: Les virements bancaires ne sont pas pris en charge pour les montants sup√©rieurs √† 5000 $.",
      "my.h2": "Mes Escrows",
      "tbl.id": "ID",
      "tbl.buyer": "Acheteur",
      "tbl.status": "Statut",
      "tbl.amount": "Montant",
      "tbl.wallet": "Portefeuille",
      "tbl.actions": "Actions",
      "transactions.h2": "Transactions",
      "kyc.h2": "KYC",
      "kyc.note": "La v√©rification KYC sera demand√©e aux vendeurs qui choisissent de recevoir le paiement par virement bancaire."
    }
  },
  it: {
    translation: {
      "title": "Dashboard Venditore ‚Äî VanGuard Escrow",
      "header.title": "Dashboard Venditore",
      "btn.logout": "Disconnetti",
      "nav.escrow": "Configurazione Escrow",
      "nav.my_escrows": "I Miei Escrow",
      "nav.transactions": "Transazioni",
      "nav.kyc": "KYC",
      "pending.h2": "Escrow in sospeso",
      "pending.desc": "Rivedi le richieste di escrow avviate dall'acquirente in attesa della tua conferma.",
      "delivery.h2": "Invia consegna e termini",
      "release.h2": "Richiedi rilascio pagamento",
      "release.desc": "Richiedi all'acquirente di rilasciare il pagamento dopo aver completato la consegna.",
      "withdrawal.h2": "Scegli il metodo di prelievo",
      "withdrawal.desc": "Seleziona come desideri ricevere il tuo pagamento una volta completato l'escrow.",
      "method.trc": "USDT TRC20",
      "method.erc": "USDT ERC20",
      "method.bep": "BTC (BEP20)",
      "method.cashapp": "Cash App (solo USA)",
      "method.bank": "Bonifico bancario (Revolut Instant)",
      "method.bank_note": "Contatta l'amministratore in diretta su Google Meet o via email support@vanguardescrow.online",
      "btn.copy": "Copia",
      "btn.select_withdrawal": "Seleziona metodo di prelievo",
      "btn.info": "Info",
      "btn.use_custom": "Usa personalizzato",
      "btn.clear": "Cancella",
      "btn.submit_delivery": "Invia consegna",
      "btn.request_release": "Richiedi rilascio",
      "btn.confirm_escrow": "Conferma escrow",
      "btn.reject_escrow": "Rifiuta escrow",
      "ph.custom": "Inserisci metodo di prelievo personalizzato",
      "ph.escrow_id": "ID Escrow",
      "ph.delivery_terms": "Descrivi i tuoi consegnabili o termini...",
      "ph.deliverable_content": "Incolla testo consegnabile, link di download o istruzioni...",
      "label.delivery_terms": "Termini di consegna:",
      "label.deliverable_content": "Contenuto consegnabile:",
      "label.attach_files": "Allega file:",
      "label.selected_files": "File selezionati:",
      "note.bank_limit": "NB: I bonifici bancari non sono supportati per importi superiori a $5000.",
      "my.h2": "I Miei Escrow",
      "tbl.id": "ID",
      "tbl.buyer": "Acquirente",
      "tbl.status": "Stato",
      "tbl.amount": "Importo",
      "tbl.wallet": "Portafoglio",
      "tbl.actions": "Azioni",
      "transactions.h2": "Transazioni",
      "kyc.h2": "KYC",
      "kyc.note": "La verifica KYC sar√† richiesta ai venditori che scelgono di ricevere il pagamento tramite bonifico bancario."
    }
  },
  es: {
    translation: {
      "title": "Panel de Vendedor ‚Äî VanGuard Escrow",
      "header.title": "Panel de Vendedor",
      "btn.logout": "Cerrar sesi√≥n",
      "nav.escrow": "Configuraci√≥n de Escrow",
      "nav.my_escrows": "Mis Escrows",
      "nav.transactions": "Transacciones",
      "nav.kyc": "KYC",
      "pending.h2": "Escrows pendientes",
      "pending.desc": "Revise las solicitudes de escrow iniciadas por el comprador que esperan su confirmaci√≥n.",
      "delivery.h2": "Enviar entrega y t√©rminos",
      "release.h2": "Solicitar liberaci√≥n de pago",
      "release.desc": "Solicite al comprador que libere el pago despu√©s de completar la entrega.",
      "withdrawal.h2": "Elegir m√©todo de retiro",
      "withdrawal.desc": "Seleccione c√≥mo desea recibir su pago una vez completado el escrow.",
      "method.trc": "USDT TRC20",
      "method.erc": "USDT ERC20",
      "method.bep": "BTC (BEP20)",
      "method.cashapp": "Cash App (solo EE. UU.)",
      "method.bank": "Transferencia bancaria (Revolut Instant)",
      "method.bank_note": "Contacte al administrador en vivo en Google Meet o por correo electr√≥nico support@vanguardescrow.online",
      "btn.copy": "Copiar",
      "btn.select_withdrawal": "Seleccionar m√©todo de retiro",
      "btn.info": "Info",
      "btn.use_custom": "Usar personalizado",
      "btn.clear": "Limpiar",
      "btn.submit_delivery": "Enviar entrega",
      "btn.request_release": "Solicitar liberaci√≥n",
      "btn.confirm_escrow": "Confirmar escrow",
      "btn.reject_escrow": "Rechazar escrow",
      "ph.custom": "Ingrese m√©todo de retiro personalizado",
      "ph.escrow_id": "ID de Escrow",
      "ph.delivery_terms": "Describa sus entregables o t√©rminos...",
      "ph.deliverable_content": "Pegue texto entregable, enlaces de descarga o instrucciones...",
      "label.delivery_terms": "T√©rminos de entrega:",
      "label.deliverable_content": "Contenido entregable:",
      "label.attach_files": "Adjuntar archivos:",
      "label.selected_files": "Archivos seleccionados:",
      "note.bank_limit": "NB: Las transferencias bancarias no est√°n soportadas para montos superiores a $5000.",
      "my.h2": "Mis Escrows",
      "tbl.id": "ID",
      "tbl.buyer": "Comprador",
      "tbl.status": "Estado",
      "tbl.amount": "Monto",
      "tbl.wallet": "Billetera",
      "tbl.actions": "Acciones",
      "transactions.h2": "Transacciones",
      "kyc.h2": "KYC",
      "kyc.note": "Se requerir√° verificaci√≥n KYC para vendedores que elijan recibir el pago mediante transferencia bancaria."
    }
  }
};

i18next.init({
  lng: 'en',
  debug: false,
  resources: translations
}, function(err, t) {
  updateContent();
});

function updateContent() {
  document.querySelectorAll('[data-i18n]').forEach(element => {
    const key = element.getAttribute('data-i18n');
    element.textContent = i18next.t(key);
  });
  
  document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
    const key = element.getAttribute('data-i18n-placeholder');
    element.placeholder = i18next.t(key);
  });
  
  document.title = i18next.t('title');
}

document.getElementById('langSwitcher')?.addEventListener('change', function(e) {
  i18next.changeLanguage(e.target.value, () => {
    updateContent();
  });
});

document.addEventListener('DOMContentLoaded', () => {
  const copyButtons = document.querySelectorAll('.copy-btn');
  copyButtons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      const val = btn.getAttribute('data-val');
      if (val && val !== 'BankTransferInfo') {
        navigator.clipboard.writeText(val).then(() => {
          const original = btn.textContent;
          btn.textContent = '‚úì Copied!';
          setTimeout(() => {
            btn.textContent = original;
          }, 2000);
        });
      } else if (val === 'BankTransferInfo') {
        alert('Bank Transfer Info:\nContact Live Admin via Google Meet or email support@vanguardescrow.online');
      }
    });
  });

  const useButtons = document.querySelectorAll('.use-btn');
  useButtons.forEach(btn => {
    if (btn.id !== 'useCustomBtn' && btn.id !== 'clearSelected') {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        const val = btn.getAttribute('data-val');
        if (val) {
          document.getElementById('selectedPaymentText').textContent = val;
          document.getElementById('selectedPaymentDisplay').style.display = 'flex';
        }
      });
    }
  });

  document.getElementById('useCustomBtn')?.addEventListener('click', (e) => {
    e.preventDefault();
    const custom = document.getElementById('customPayment').value.trim();
    if (custom) {
      document.getElementById('selectedPaymentText').textContent = custom;
      document.getElementById('selectedPaymentDisplay').style.display = 'flex';
    }
  });

  document.getElementById('clearSelected')?.addEventListener('click', (e) => {
    e.preventDefault();
    document.getElementById('selectedPaymentDisplay').style.display = 'none';
    document.getElementById('selectedPaymentText').textContent = '--';
  });
});
</script>
</body>
</html>
